(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87316,t=>{"use strict";let e=(0,t.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);t.s(["Calendar",()=>e],87316)},63059,t=>{"use strict";let e=(0,t.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);t.s(["ChevronRight",()=>e],63059)},18566,(t,e,r)=>{e.exports=t.r(76562)},9165,t=>{"use strict";let e=new Map;async function r(t,e={},a=1e4,i=2){let o=new AbortController,l=setTimeout(()=>o.abort("request timeout"),a);try{let r=await fetch(t,{...e,signal:o.signal});return clearTimeout(l),r}catch(o){if(clearTimeout(l),i>0)return console.warn(`请求失败，正在重试 (剩余${i}次):`,o),r(t,e,a,i-1);throw o}}class a{maxConcurrent;queue;activeCount;constructor(t){this.maxConcurrent=t,this.queue=[],this.activeCount=0}async run(t){return new Promise((e,r)=>{let a=async()=>{this.activeCount++;try{let r=await t();e(r)}catch(t){r(t)}finally{this.activeCount--,this.next()}};this.activeCount<this.maxConcurrent?a():this.queue.push(a)})}next(){if(this.queue.length>0&&this.activeCount<this.maxConcurrent){let t=this.queue.shift();t&&t()}}}let i=new a(3),o=new a(5);function l(t){let e;if(!1===t.proxyEnabled)return;let r=(e=localStorage.getItem("proxySettings"))?JSON.parse(e):null;if(r?.enabled&&r?.proxyUrl)return r.proxyUrl}async function n(t,e,a=1){if(!t.apiUrl)throw Error("视频源API地址为空");let i=new URL("/api/proxy",window.location.origin);i.searchParams.set("apiUrl",t.apiUrl),i.searchParams.set("wd",e),i.searchParams.set("pg",a.toString());let o=l(t);o&&i.searchParams.set("proxyUrl",o);let s=await r(i.toString(),{method:"GET",headers:{"Content-Type":"application/json"}},t.timeout||1e4,t.retry||2);if(!s.ok)throw Error(`API请求失败: ${s.status}`);let c=await s.json();if(1===c.code)return{list:c.list.map(e=>({...e,sourceId:t.id,sourceName:t.name})),total:c.total};throw Error(c.msg||"搜索失败")}async function s(t,e,r=1){if(!t||0===t.length)throw Error("没有可用的视频源");let a=t.map(t=>o.run(()=>n(t,e,r).catch(e=>(console.error(`源 ${t.name} 搜索失败:`,e),{list:[],total:0})))),i=await Promise.all(a);return{list:i.flatMap(t=>t.list),total:i.reduce((t,e)=>t+e.total,0)}}function c(t,e,r,a,i=1){if(!t||0===t.length)return Promise.resolve([]);let l=!1;if(a){if(a.aborted)return Promise.reject(new DOMException("Aborted","AbortError"));a.addEventListener("abort",()=>{l=!0})}let s=new Set,u=Promise.all(t.map(t=>o.run(async()=>{if(l)return[];let a=[];try{a=(await n(t,e,i)).list}catch(e){if(l)return[];console.warn(`${t.name} 源搜索失败:`,e)}if(l)return[];let o=a.filter(t=>{let e=`${t.sourceId}_${t.vod_id}`;return!s.has(e)&&(s.add(e),!0)});return!l&&o.length>0&&r(o),o}))).then(t=>t.flat());return a?Promise.race([u,new Promise((t,e)=>{a.addEventListener("abort",()=>{e(new DOMException("Aborted","AbortError"))})})]):u}async function u(t,a){if(!t.apiUrl)throw Error("视频源API地址为空");let o=`${t.id}-${a}`,n=e.get(o);return n&&Date.now()-n.timestamp<3e5?n.data:i.run(async()=>{let i=new URL("/api/proxy",window.location.origin);i.searchParams.set("apiUrl",t.apiUrl),i.searchParams.set("ac","detail"),i.searchParams.set("ids",a.toString());let n=l(t);n&&i.searchParams.set("proxyUrl",n);let s=await r(i.toString(),{method:"GET",headers:{"Content-Type":"application/json"}},t.timeout||1e4,t.retry||2);if(!s.ok)throw Error(`API请求失败: ${s.status}`);let c=await s.json();if(1===c.code&&c.list&&c.list.length>0){let t=c.list[0];return e.set(o,{data:t,timestamp:Date.now()}),t}throw Error(c.msg||"获取视频详情失败")})}async function h(t,e){let r={};for(let a=0;a<t.length;a+=3){let i=t.slice(a,a+3);(await Promise.allSettled(i.map(async t=>{if(!t.sourceId||!t.vod_id)return null;let r=e.find(e=>e.id===t.sourceId);if(!r)return null;try{let e=await u(r,t.vod_id);return{vod_id:t.vod_id,vod_pic:e.vod_pic}}catch{return null}}))).forEach(t=>{"fulfilled"===t.status&&t.value&&t.value.vod_pic&&(r[t.value.vod_id]=t.value.vod_pic)}),a+3<t.length&&await new Promise(t=>setTimeout(t,200))}return r}function d(t){if(!t)return[];let e=[];return t.split("#").forEach((t,r)=>{let[a,i]=t.split("$");i&&e.push({label:a||`第${r+1}集`,url:i.replace(/\\/g,""),index:r})}),e}t.s(["aggregatedSearch",()=>c,"batchGetVideoCovers",()=>h,"buildProxyUrl",()=>l,"getVideoDetail",()=>u,"parsePlayUrl",()=>d,"searchVideosAll",()=>s])},3116,t=>{"use strict";let e=(0,t.i(75254).default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);t.s(["Clock",()=>e],3116)},70273,t=>{"use strict";let e=(0,t.i(75254).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);t.s(["Star",()=>e],70273)}]);